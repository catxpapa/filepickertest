<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>懒猫文件选择器测试应用</title>
    <link rel="stylesheet" href="style.css">
    <!-- 引入懒猫文件选择器插件 [citation](2) -->
    <script defer src="https://unpkg.com/@lazycatcloud/lzc-file-pickers@latest/dist/lzc-file-pickers.umd.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>📁 懒猫文件选择器测试应用</h1>
            <p>懒猫官方文件选择器插件功能测试 - 按需加载，减少系统压力</p>
            <div id="envInfo" class="env-info">
                <p>正在加载环境信息...</p>
            </div>
        </header>

        <!-- 文件选择器容器 - 只显示当前激活的选择器 -->
        <div id="pickerContainer" class="picker-container" style="display: none;">
            <div class="picker-header">
                <h3 id="pickerTitle">文件选择器</h3>
                <button id="closePicker" class="btn btn-close">关闭</button>
            </div>
            
            <!-- 文件选择器组件 - 动态创建 [citation](2) -->
            <div id="pickerWrapper"></div>
        </div>

        <div class="section">
            <h2>🎛️ 懒猫文件选择器测试</h2>
            <div class="picker-selector">
                <h3>选择要测试的文件选择器类型：</h3>
                <div class="button-group">
                    <button id="testFileSelector" class="btn btn-primary" data-type="file">
                        📄 文件选择器
                        <small>选择单个或多个文件</small>
                    </button>
                    <button id="testDirSelector" class="btn btn-info" data-type="dir">
                        📁 目录选择器
                        <small>选择文件夹</small>
                    </button>
                    <button id="testFileSaver" class="btn btn-success" data-type="saveAs">
                        💾 文件保存器
                        <small>保存文件到网盘</small>
                    </button>
                </div>
            </div>
            
            <div class="debug-section">
                <h3>调试工具：</h3>
                <button id="debugEnv" class="btn btn-warning">调试环境信息</button>
                <button id="testConnection" class="btn btn-secondary">测试连接</button>
            </div>
        </div>

        <!-- 本地文件上传测试部分 -->
        <div class="section">
            <h2>📤 本地文件上传测试</h2>
            <div class="upload-test-area">
                <div class="upload-info">
                    <p><strong>功能说明：</strong>选择本地文件并上传到当前选择的存储目录</p>
                    <p><strong>当前存储目录：</strong> <span id="uploadTargetPath">/lzcapp/var/uploads</span></p>
                    <p><strong>支持格式：</strong> 图片(jpg,png,gif,webp)、PDF、文档(txt,doc,docx)、压缩包(zip)</p>
                    <p><strong>大小限制：</strong> 单文件最大 10MB，最多同时上传 5 个文件</p>
                </div>
                
                <!-- 隐藏的文件输入框 -->
                <input type="file" id="localFileInput" multiple 
                       accept="image/*,application/pdf,.txt,.doc,.docx,.zip"
                       style="display: none;">
                
                <div class="file-input-area">
                    <div class="upload-buttons">
                        <button id="selectFilesBtn" class="btn btn-primary">📁 选择本地文件</button>
                        <button id="uploadFilesBtn" class="btn btn-success" disabled>📤 上传到存储目录</button>
                        <button id="clearSelectionBtn" class="btn btn-secondary">🗑️ 清空选择</button>
                    </div>
                </div>
                
                <div id="selectedFilesPreview" class="selected-files-preview" style="display: none;">
                    <h4>已选择的文件：</h4>
                    <div id="filePreviewList" class="file-preview-list"></div>
                </div>
                
                <div id="uploadProgressContainer" class="upload-progress-container" style="display: none;">
                    <h4>上传进度：</h4>
                    <div class="progress-bar">
                        <div id="uploadProgressBar" class="progress-fill"></div>
                    </div>
                    <div id="uploadStatus" class="upload-status"></div>
                </div>
            </div>
        </div>

        <!-- 懒猫微服存储目录配置 -->
        <div class="section storage-config">
            <h2>📂 存储目录配置</h2>
            <div class="storage-options">
                <label class="storage-option">
                    <input type="radio" name="storageType" value="var" checked>
                    <div class="storage-details">
                        <span class="storage-label">应用存储目录</span>
                        <code>/lzcapp/var</code>
                        <small>持久化存储，应用卸载时可选择保留数据</small>
                    </div>
                </label>
                <label class="storage-option">
                    <input type="radio" name="storageType" value="cache">
                    <div class="storage-details">
                        <span class="storage-label">缓存目录</span>
                        <code>/lzcapp/cache</code>
                        <small>临时存储，用户可手动清理的缓存文件</small>
                    </div>
                </label>
                <label class="storage-option">
                    <input type="radio" name="storageType" value="home">
                    <div class="storage-details">
                        <span class="storage-label">用户文档目录</span>
                        <code>/lzcapp/run/mnt/home</code>
                        <small>用户网盘目录，与懒猫网盘同步</small>
                    </div>
                </label>
            </div>
            <div class="current-storage">
                <p><strong>当前存储目录:</strong> <span id="currentStorage">/lzcapp/var</span></p>
            </div>
        </div>

        <div class="section">
            <h2>📋 已上传文件管理</h2>
            <div class="file-management">
                <div class="file-controls">
                    <button id="refreshFileList" class="btn btn-secondary">刷新文件列表</button>
                    <button id="clearAllFiles" class="btn btn-danger">清空所有文件</button>
                    <select id="storageTypeSelect" class="storage-select">
                        <option value="var">应用存储目录 (/lzcapp/var)</option>
                        <option value="cache">缓存目录 (/lzcapp/cache)</option>
                        <option value="home">用户文档目录 (/lzcapp/run/mnt/home)</option>
                        <option value="temp">临时目录 (/tmp)</option>
                    </select>
                </div>
                
                <div id="fileListContainer" class="file-list-container">
                    <div id="storageInfo" class="storage-info"></div>
                    <div id="uploadedFilesList" class="uploaded-files-list">
                        <p class="placeholder">点击刷新按钮加载文件列表...</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>📊 操作结果</h2>
            <div id="results" class="results-container">
                <p class="placeholder">选择文件选择器类型开始测试...</p>
            </div>
        </div>

        <div class="section">
            <h2>📈 状态信息</h2>
            <div id="status" class="status-container">
                <p>应用已就绪，等待操作...</p>
            </div>
        </div>
    </div>

    <!-- 引入 JavaScript 文件 -->
    <script src="app.js"></script>
</body>
</html>